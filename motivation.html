<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Motivation Tool</title>
<link href="https://fonts.googleapis.com/css2?family=Barriecito&family=Winky+Sans&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
<style>
body {
  background-color: #fff7e6;
  font-family: 'Winky Sans', sans-serif;
  color: #1b3a2d;
  text-align: center;
  padding: 20px;
}
h1, h2 {
  font-family: 'Barriecito', cursive;
  color: #ffb6a0;
}
#stepsContainer {
  display: inline-block;
  text-align: left;
  margin-top: 20px;
}
.check-item {
  margin: 10px 0;
}
.check-item label {
  margin-left: 6px;
}
select, input[type="text"] {
  margin-left: 8px;
  padding: 4px 6px;
  font-family: 'Winky Sans', sans-serif;
}
.pink-btn {
  background-color: #ffb6a0;
  color: #fff;
  border: none;
  padding: 10px 16px;
  margin: 5px;
  border-radius: 8px;
  cursor: pointer;
}
.pink-btn:hover {
  background-color: #ffa089;
}
.green-btn {
  background-color: #1b3a2d;
  color: #fff;
  border: none;
  padding: 10px 16px;
  margin: 5px;
  border-radius: 8px;
  cursor: pointer;
}
.green-btn:hover {
  background-color: #163026;
}
#buttonContainer {
  margin-top: 20px;
}
</style>
</head>
<body>

<h1>Motivation Tool</h1>

<label for="taskSelect">Choose Overall Task:</label>
<select id="taskSelect">
  <option value="Empty Dishwasher">Empty Dishwasher</option>
  <option value="Clean Bathroom">Clean Bathroom</option>
  <option value="custom">Custom Task...</option>
</select>

<h2 id="currentTaskName">Empty Dishwasher</h2>

<div id="stepsContainer"></div>

<div id="buttonContainer">
  <button id="addStepBtn" class="pink-btn">Add Step</button>
  <button id="addRewardBtn" class="pink-btn">Add Reward</button>
  <button id="homeBtn" class="green-btn" onclick="window.location.href='index.html'">Back to Home</button>
</div>

<audio id="celebrationSound" src="click.mp3"></audio>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const taskSelect = document.getElementById('taskSelect');
  const currentTaskNameEl = document.getElementById('currentTaskName');
  const stepsContainer = document.getElementById('stepsContainer');
  const celebrationSound = document.getElementById('celebrationSound');

  const prefilledTasks = {
    "Empty Dishwasher": [
      { step: 'Put cutlery away', reward: 'Listen to a song' },
      { step: 'Put plates away', reward: 'Watch a short YouTube video' },
      { step: 'Put bowls away', reward: '3 minute social media scroll' },
      { step: 'Put cups/glasses away', reward: '' },
      { step: 'Put mugs away', reward: '' },
      { step: 'Put remaining dishes away', reward: '' }
    ],
    "Clean Bathroom": [
      { step: 'Scrub sink', reward: 'Drink a coffee' },
      { step: 'Clean toilet', reward: 'Stretch for 3 mins' },
      { step: 'Wipe mirror', reward: '' },
      { step: 'Mop floor', reward: '' }
    ]
  };

  const rewardOptions = [
    'Listen to a song',
    'Watch a short YouTube video',
    '3 minute social media scroll',
    'Eat a snack',
    'Take a short walk',
    'Custom reward'
  ];

  const bigRewardOptions = [
    'Watch an episode',
    'Go for a walk',
    'Listen to an album',
    'Dance',
    'Relax on the couch',
    'Eat something yum',
    'Custom reward'
  ];

  function createRewardDropdown(initialText='') {
    const select = document.createElement('select');
    rewardOptions.forEach(opt=>{
      const option = document.createElement('option');
      option.value = opt;
      option.textContent = opt;
      if(opt===initialText) option.selected = true;
      select.appendChild(option);
    });

    select.addEventListener('change', ()=>{
      if(select.value==='Custom reward'){
        const input = document.createElement('input');
        input.type='text';
        input.placeholder='Enter your reward';
        input.style.marginLeft='10px';
        input.addEventListener('change', ()=>{
          const newOption = document.createElement('option');
          newOption.value = input.value;
          newOption.textContent = input.value;
          select.insertBefore(newOption, select.lastChild);
          select.value = input.value;
          input.remove();
          select.style.display = '';
        });
        select.after(input);
        select.style.display='none';
        input.focus();
      }
    });
    return select;
  }

  function addStepWithReward(stepText='', rewardText='') {
    // Step
    if(stepText){
      const stepDiv = document.createElement('div');
      stepDiv.classList.add('check-item');
      const stepCheckbox = document.createElement('input');
      stepCheckbox.type='checkbox';
      stepCheckbox.addEventListener('change', ()=>{ if(stepCheckbox.checked) celebrationSound.play(); });
      const stepLabel = document.createElement('label');
      stepLabel.textContent=stepText;
      stepDiv.appendChild(stepCheckbox);
      stepDiv.appendChild(stepLabel);
      stepsContainer.insertBefore(stepDiv, document.getElementById('finalReward') || null);
    }
    // Reward
    if(rewardText!==undefined){
      const rewardDiv = document.createElement('div');
      rewardDiv.classList.add('check-item');
      const rewardCheckbox = document.createElement('input');
      rewardCheckbox.type='checkbox';
      rewardCheckbox.addEventListener('change', ()=>{ if(rewardCheckbox.checked) celebrationSound.play(); });
      const rewardDropdown = createRewardDropdown(rewardText);
      rewardDiv.appendChild(rewardCheckbox);
      rewardDiv.appendChild(rewardDropdown);
      stepsContainer.insertBefore(rewardDiv, document.getElementById('finalReward') || null);
    }
  }

  function addFinalReward(){
    const finalContainer = document.createElement('div');
    finalContainer.id='finalReward';
    finalContainer.style.textAlign='center';
    finalContainer.style.marginTop='20px';

    const finalText = document.createElement('h3');
    finalText.textContent='Task completed! GO YOU!!';
    finalContainer.appendChild(finalText);

    const bigDiv = document.createElement('div');
    bigDiv.classList.add('check-item');
    const bigCheckbox = document.createElement('input');
    bigCheckbox.type='checkbox';
    bigCheckbox.addEventListener('change', ()=>{ if(bigCheckbox.checked) celebrationSound.play(); });

    const bigDropdown = document.createElement('select');
    bigRewardOptions.forEach(opt=>{
      const option = document.createElement('option');
      option.value = opt;
      option.textContent = opt;
      bigDropdown.appendChild(option);
    });
    bigDropdown.addEventListener('change', ()=>{
      if(bigDropdown.value==='Custom reward'){
        const input = document.createElement('input');
        input.type='text';
        input.placeholder='Enter your reward';
        input.style.marginLeft='10px';
        input.addEventListener('change', ()=>{
          const newOption = document.createElement('option');
          newOption.value = input.value;
          newOption.textContent = input.value;
          bigDropdown.insertBefore(newOption, bigDropdown.lastChild);
          bigDropdown.value = input.value;
          input.remove();
          bigDropdown.style.display='';
        });
        bigDropdown.after(input);
        bigDropdown.style.display='none';
        input.focus();
      }
    });

    bigDiv.appendChild(bigCheckbox);
    bigDiv.appendChild(bigDropdown);
    finalContainer.appendChild(bigDiv);
    stepsContainer.appendChild(finalContainer);
  }

  function renderChecklist(taskName){
    stepsContainer.innerHTML='';
    const stepsArray = prefilledTasks[taskName] || [];
    stepsArray.forEach(item=>{
      addStepWithReward(item.step, item.reward);
    });
    addFinalReward();
  }

  // Task select
  taskSelect.addEventListener('change', ()=>{
    const selected = taskSelect.value;
    if(selected==='custom'){
      const name = prompt('Enter custom task name:');
      currentTaskNameEl.textContent = name && name.trim() ? name.trim() : 'Custom Task';
      stepsContainer.innerHTML='';
      addFinalReward();
    }else{
      currentTaskNameEl.textContent = selected;
      renderChecklist(selected);
    }
  });

  // Add Step
  document.getElementById('addStepBtn').addEventListener('click', ()=>{
    const name = prompt('Enter step name:');
    if(name && name.trim()!==''){
      addStepWithReward(name.trim(), '');
    }
  });

  // Add Reward
  document.getElementById('addRewardBtn').addEventListener('click', ()=>{
    addStepWithReward('', '');
  });

  // Load default
  renderChecklist('Empty Dishwasher');
});
</script>
</body>
</html>
