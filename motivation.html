<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Motivation Tool</title>
<link rel="stylesheet" href="style.css">
<link href="https://fonts.googleapis.com/css2?family=Barriecito&family=Winky+Sans&display=swap" rel="stylesheet">
<style>
  body { font-family: 'Winky Sans', sans-serif; background-color: #fdf6e3; color: #1b3a2d; padding:20px; text-align:center; }
  h1 { font-family: 'Barriecito', cursive; font-size:3rem; color:#ff9aa2; margin-bottom:20px; }
  label { margin-left:8px; display:block; margin-bottom:10px; }
  #motivationChecklist {
    list-style: none;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  li {
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 10px 0;
  }
  select { margin-left:10px; }
  .special-reward-text { color:#ff6f61; font-weight:bold; font-size:1.3em; margin-top:20px; }
  .btn { background-color:#ff9aa2; color:#fdf6e3; border:none; padding:10px 15px; cursor:pointer; margin-top:10px; font-family:'Barriecito', cursive; display:block; margin-left:auto; margin-right:auto; }
</style>
</head>
<body>

<h1>Motivation Tool</h1>

<label>Choose Overall Task: 
  <select id="taskSelect">
    <option value="emptyDishwasher">Empty Dishwasher</option>
    <option value="cleanBathroom">Clean Bathroom</option>
    <option value="writeEssay">Write Essay</option>
    <option value="laundry">Do Laundry</option>
    <option value="custom">Custom...</option>
  </select>
</label>

<ul id="motivationChecklist"></ul>

<button id="addTaskBtn" class="btn">Add Custom Step</button>
<button id="addRewardBtn" class="btn">Add Custom Reward</button>
<br>
<button onclick="window.location.href='index.html'" class="btn">Back to Home</button>

<!-- Sounds -->
<audio id="celebrationSound" src="celebration.mp3"></audio>
<audio id="dingSound" src="ding.mp3"></audio>

<script>
const checklistEl = document.getElementById('motivationChecklist');
const celebrationSound = document.getElementById('celebrationSound');
const dingSound = document.getElementById('dingSound');

const taskSelect = document.getElementById('taskSelect');
const preRewards = ["Snack", "Youtube", "Social media scroll ", "Drink", "Song", "Stretch"];
const bigRewards = ["Watch an episode", "Go for a walk", "Listen to an album", "Dance", "Relax on the couch", "Eat something yum"];

// Task templates
const taskTemplates = {
  emptyDishwasher: [
    {type:'task', text:'Put cutlery away'},
    {type:'reward', text:'Listen to a song'},
    {type:'task', text:'Put plates away'},
    {type:'reward', text:'Watch a short YouTube video'},
    {type:'task', text:'Put bowls away'},
    {type:'reward', text:'3 minute social media scroll'},
    {type:'task', text:'Put cups/glasses away'},
    {type:'reward', text:''},
    {type:'task', text:'Put mugs away'},
    {type:'reward', text:''},
    {type:'task', text:'Put remaining dishes away'},
    {type:'special', text:''}
  ],
  cleanBathroom: [
    {type:'task', text:'Clean sink'},
    {type:'reward', text:'5 minute break'},
    {type:'task', text:'Scrub toilet'},
    {type:'reward', text:'Snack'},
    {type:'task', text:'Mop floor'},
    {type:'special', text:''}
  ],
  writeEssay: [
    {type:'task', text:'Outline essay'},
    {type:'reward', text:'Coffee break'},
    {type:'task', text:'Write introduction'},
    {type:'reward', text:'Short video'},
    {type:'task', text:'writr first paragraph'},
    {type:'special', text:''}
  ],
  laundry: [
    {type:'task', text:'Sort clothes'},
    {type:'reward', text:'Snack'},
    {type:'task', text:'Load washing machine'},
    {type:'reward', text:'Stretch'},
    {type:'task', text:'Hang wet clothes'},
    {type:'special', text:''}
  ]
};

let items = JSON.parse(JSON.stringify(taskTemplates['emptyDishwasher']));

function renderChecklist(){
  checklistEl.innerHTML='';
  items.forEach((item,index)=>{
    const li = document.createElement('li');

    if(item.type==='task'){
      const checkbox = document.createElement('input');
      checkbox.type='checkbox';
      checkbox.checked=item.checked;
      checkbox.addEventListener('change', ()=>{
        item.checked = checkbox.checked;
        if(checkbox.checked){ celebrationSound.currentTime=0; celebrationSound.play().catch(err=>console.log(err)); }
      });
      li.appendChild(checkbox);
      li.appendChild(document.createTextNode(' '+item.text));
    } 
    else if(item.type==='reward'){
      const checkbox = document.createElement('input');
      checkbox.type='checkbox';
      checkbox.checked=item.checked;
      const select = document.createElement('select');

      preRewards.forEach(r=>{
        const option = document.createElement('option');
        option.value=r; option.textContent=r;
        if(r===item.text) option.selected=true;
        select.appendChild(option);
      });
      const customOption = document.createElement('option');
      customOption.value='custom';
      customOption.textContent='Custom...';
      select.appendChild(customOption);

      select.addEventListener('change', ()=>{
        if(select.value==='custom'){
          const customReward = prompt("Enter custom reward:");
          if(customReward){
            item.text = customReward;
            // Add new option if it doesn't exist
            if(!Array.from(select.options).some(opt=>opt.value===customReward)){
              const newOption = document.createElement('option');
              newOption.value = customReward;
              newOption.textContent = customReward;
              select.add(newOption, select.options[select.options.length-1]); // before Custom...
            }
            select.value = customReward;
            renderChecklist();
          } else { select.value=''; }
        } else {
          item.text = select.value;
          renderChecklist();
        }
      });

      checkbox.addEventListener('change', ()=>{
        item.checked = checkbox.checked;
        if(checkbox.checked){ dingSound.currentTime=0; dingSound.play().catch(err=>console.log(err)); }
      });

      li.appendChild(checkbox);
      li.appendChild(document.createTextNode(' Reward: '));
      li.appendChild(select);
    } 
    else if(item.type==='special'){
      const span = document.createElement('div');
      span.className='special-reward-text';
      span.textContent = "Task completed! GO YOU!!";
      li.appendChild(span);
      checklistEl.appendChild(li);

      // Big special reward row with checkbox
      const rewardLi = document.createElement('li');
      const rewardCheckbox = document.createElement('input');
      rewardCheckbox.type='checkbox';
      rewardCheckbox.addEventListener('change', ()=>{
        if(rewardCheckbox.checked){ dingSound.currentTime=0; dingSound.play().catch(err=>console.log(err)); }
      });
      const bigSelect = document.createElement('select');
      bigRewards.forEach(r=>{
        const option = document.createElement('option');
        option.value=r; option.textContent=r;
        bigSelect.appendChild(option);
      });
      const customOption = document.createElement('option');
      customOption.value='custom'; customOption.textContent='Custom...';
      bigSelect.appendChild(customOption);
      bigSelect.addEventListener('change', ()=>{
        if(bigSelect.value==='custom'){
          const customReward = prompt("Enter custom reward:");
          if(customReward){ 
            if(!Array.from(bigSelect.options).some(opt=>opt.value===customReward)){
              const newOption = document.createElement('option');
              newOption.value = customReward;
              newOption.textContent = customReward;
              bigSelect.add(newOption, bigSelect.options.length-1);
            }
            bigSelect.value = customReward;
          } else bigSelect.value='';
        }
      });
      rewardLi.appendChild(rewardCheckbox);
      rewardLi.appendChild(document.createTextNode(' Big, special reward: '));
      rewardLi.appendChild(bigSelect);
      checklistEl.appendChild(rewardLi);
      return;
    }

    checklistEl.appendChild(li);
  });
}
// Handle task title change and load steps/rewards
document.getElementById("taskTitle").addEventListener("change", function () {
    const selectedTask = this.value;
    const taskListContainer = document.getElementById("taskList");
    taskListContainer.innerHTML = ""; // Clear old list

    let steps = [];
    let rewards = [];

    if (selectedTask === "Empty Dishwasher") {
        steps = [
            "Put cutlery away",
            "Put plates away",
            "Put bowls away",
            "Put cups/glasses away",
            "Put mugs away",
            "Put remaining dishes away"
        ];
        rewards = [
            "Listen to a song",
            "Watch a short YouTube video",
            "3 minute social media scroll",
            "", // user chooses from dropdown
            "", // user chooses from dropdown
            ""  // user chooses from dropdown
        ];
    } 
    else if (selectedTask === "Clean Bathroom") {
        steps = [
            "Wipe down sink",
            "Scrub toilet",
            "Clean shower/bath",
            "Mop floor"
        ];
        rewards = [
            "Drink a glass of water",
            "Stretch",
            "Listen to music",
            "" // user chooses from dropdown
        ];
    } 
    else if (selectedTask === "Custom Task") {
        const customTitle = prompt("Enter your custom task title:");
        if (customTitle) {
            this.options[this.selectedIndex].text = customTitle; // Update dropdown display
        }
        // Start with an empty list so the user can add their own
        steps = [];
        rewards = [];
    }

    // Build checklist
    steps.forEach((step, index) => {
        addStepWithReward(step, rewards[index] || "");
    });

    // Add final reward section
    const finalText = document.createElement("h3");
    finalText.textContent = "Task completed! GO YOU!!";
    finalText.style.textAlign = "center";
    taskListContainer.appendChild(finalText);

    addFinalReward();
});

// Add custom step before final special reward
document.getElementById('addTaskBtn').addEventListener('click', ()=>{
  const text = prompt("Enter step description:");
  if(text){
    let insertIndex = items.findIndex(i=>i.type==='special') !== -1 ? items.findIndex(i=>i.type==='special') : items.length;
    items.splice(insertIndex,0,{type:'task', text:text, checked:false});
    renderChecklist();
  }
});

// Add custom reward before final special reward
document.getElementById('addRewardBtn').addEventListener('click', ()=>{
  const text = prompt("Enter reward description:");
  if(text){
    let insertIndex = items.findIndex(i=>i.type==='special') !== -1 ? items.findIndex(i=>i.type==='special') : items.length;
    items.splice(insertIndex,0,{type:'reward', text:text, checked:false});
    renderChecklist();
  }
});

renderChecklist();
</script>
</body>
</html>
