<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Motivation Tool</title>
<link rel="stylesheet" href="style.css">
<link href="https://fonts.googleapis.com/css2?family=Barriecito&family=Winky+Sans&display=swap" rel="stylesheet">
<style>
  body { font-family: 'Winky Sans', sans-serif; background-color: #fdf6e3; color: #1b3a2d; padding:20px; }
  h1 { font-family: 'Barriecito', cursive; font-size:3rem; color:#ff9aa2; text-align:center; margin-bottom:20px; }
  label { margin-left:8px; display:block; margin-bottom:10px; }
  ul { list-style:none; padding:0; }
  li { margin:10px 0; display:flex; align-items:center; }
  .reward { margin-left:30px; font-weight:bold; }
  input[type="text"], select { margin-left:10px; }
  .special-reward { color:#ff6f61; font-weight:bold; font-size:1.2em; }
  .btn { background-color:#ff9aa2; color:#fdf6e3; border:none; padding:10px 15px; cursor:pointer; margin-top:10px; font-family:'Barriecito', cursive; display:block; margin-left:auto; margin-right:auto; }
</style>
</head>
<body>

<h1>Motivation Tool</h1>

<label>Choose Overall Task: 
  <select id="taskSelect">
    <option value="emptyDishwasher">Empty Dishwasher</option>
    <option value="cleanBathroom">Clean Bathroom</option>
    <option value="writeEssay">Write Essay</option>
    <option value="laundry">Do Laundry</option>
    <option value="custom">Custom...</option>
  </select>
  <input type="text" id="customTaskInput" placeholder="Enter custom task" style="display:none;">
</label>

<ul id="motivationChecklist"></ul>

<button id="addTaskBtn" class="btn">Add Custom Step</button>
<button id="addRewardBtn" class="btn">Add Custom Reward</button>
<br>
<button onclick="window.location.href='index.html'" class="btn">Back to Home</button>

<!-- Sounds -->
<audio id="celebrationSound" src="celebration.mp3"></audio>
<audio id="dingSound" src="ding.mp3"></audio>

<script>
const checklistEl = document.getElementById('motivationChecklist');
const celebrationSound = document.getElementById('celebrationSound');
const dingSound = document.getElementById('dingSound');

const taskSelect = document.getElementById('taskSelect');
const customTaskInput = document.getElementById('customTaskInput');

const preRewards = ["Snack", "Break", "Watch a short video", "Coffee", "Song", "Stretch"];

// Task templates
const taskTemplates = {
  emptyDishwasher: [
    {type:'task', text:'Put cutlery away'},
    {type:'reward', text:'Listen to a song'},
    {type:'task', text:'Put plates away'},
    {type:'reward', text:'Watch a short YouTube video'},
    {type:'task', text:'Put bowls away'},
    {type:'reward', text:'3 minute social media scroll'},
    {type:'task', text:'Put cups/glasses away'},
    {type:'reward', text:''},
    {type:'task', text:'Put mugs away'},
    {type:'reward', text:''},
    {type:'task', text:'Put remaining dishes away'},
    {type:'reward', text:'', special:true}
  ],
  cleanBathroom: [
    {type:'task', text:'Clean sink'},
    {type:'reward', text:'5 minute break'},
    {type:'task', text:'Scrub toilet'},
    {type:'reward', text:'Snack'},
    {type:'task', text:'Mop floor'},
    {type:'reward', text:'Special reward', special:true}
  ],
  writeEssay: [
    {type:'task', text:'Outline essay'},
    {type:'reward', text:'Coffee break'},
    {type:'task', text:'Write first draft'},
    {type:'reward', text:'Short video'},
    {type:'task', text:'Edit draft'},
    {type:'reward', text:'Special reward', special:true}
  ],
  laundry: [
    {type:'task', text:'Sort clothes'},
    {type:'reward', text:'Snack'},
    {type:'task', text:'Load washer'},
    {type:'reward', text:'Stretch'},
    {type:'task', text:'Fold laundry'},
    {type:'reward', text:'Special reward', special:true}
  ]
};

let items = JSON.parse(JSON.stringify(taskTemplates['emptyDishwasher']));

// Render checklist
function renderChecklist(){
  checklistEl.innerHTML='';
  items.forEach((item,index)=>{
    const li = document.createElement('li');
    const checkbox = document.createElement('input');
    checkbox.type='checkbox';
    checkbox.checked=item.checked;

    if(item.type==='task'){
      checkbox.addEventListener('change', ()=>{
        item.checked = checkbox.checked;
        localStorage.setItem('motivationItems', JSON.stringify(items));
        if(checkbox.checked){ celebrationSound.currentTime=0; celebrationSound.play().catch(err=>console.log(err)); }
      });
      li.appendChild(checkbox);
      li.appendChild(document.createTextNode(' '+item.text));
    } else {
      const select = document.createElement('select');
      preRewards.forEach(r=>{
        const option = document.createElement('option');
        option.value=r;
        option.textContent=r;
        if(r===item.text) option.selected=true;
        select.appendChild(option);
      });
      const customOption = document.createElement('option');
      customOption.value='custom';
      customOption.textContent='Custom...';
      select.appendChild(customOption);

      const input = document.createElement('input');
      input.type='text';
      input.placeholder='Enter custom reward';
      input.style.display = preRewards.includes(item.text)?'none':'inline';
      input.value = preRewards.includes(item.text)?'':item.text;

      select.addEventListener('change', ()=>{
        if(select.value==='custom'){ input.style.display='inline'; item.text=input.value; }
        else { input.style.display='none'; item.text=select.value; }
        localStorage.setItem('motivationItems', JSON.stringify(items));
      });

      input.addEventListener('input', ()=>{
        item.text = input.value;
        localStorage.setItem('motivationItems', JSON.stringify(items));
      });

      checkbox.addEventListener('change', ()=>{
        item.checked = checkbox.checked;
        localStorage.setItem('motivationItems', JSON.stringify(items));
        if(checkbox.checked){ dingSound.currentTime=0; dingSound.play().catch(err=>console.log(err)); }
      });

      li.appendChild(checkbox);
      li.appendChild(document.createTextNode(' ' + (item.special?'Special Reward: ':'Reward: ')));
      li.appendChild(select);
      li.appendChild(input);
    }

    if(item.special){ li.className='special-reward'; }
    checklistEl.appendChild(li);
  });
}

// Handle task selection dropdown
taskSelect.addEventListener('change', ()=>{
  if(taskSelect.value==='custom'){
    customTaskInput.style.display='inline';
    items = [];
  } else {
    customTaskInput.style.display='none';
    items = JSON.parse(JSON.stringify(taskTemplates[taskSelect.value]));
  }
  renderChecklist();
});

// Custom task input
customTaskInput.addEventListener('input', ()=>{
  // Optional: save custom overall task name in localStorage
  localStorage.setItem('motivationCustomTask', customTaskInput.value);
});

// Add custom step/reward buttons
document.getElementById('addTaskBtn').addEventListener('click', ()=>{
  const text = prompt("Enter step description:");
  if(text){ items.push({type:'task', text:text, checked:false}); renderChecklist(); localStorage.setItem('motivationItems', JSON.stringify(items)); }
});
document.getElementById('addRewardBtn').addEventListener('click', ()=>{
  const text = prompt("Enter reward description:");
  if(text){ items.push({type:'reward', text:text, checked:false}); renderChecklist(); localStorage.setItem('motivationItems', JSON.stringify(items)); }
});

renderChecklist();
</script>
</body>
</html>
